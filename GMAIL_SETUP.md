# ğŸ“§ Gmail Email Setup Guide

## Email Configuration Added

âœ… **Your email added:** luqmanmirajdeen@gmail.com  
âœ… **Client email:** office@pen.com  
âœ… **All emails will be sent to BOTH addresses**

---

## ğŸ”§ **How to Enable Email Sending:**

### **Step 1: Create Gmail App Password**

1. Go to your Gmail account: https://myaccount.google.com/
2. Navigate to **Security**
3. Enable **2-Step Verification** (if not already enabled)
4. Go to **App Passwords**: https://myaccount.google.com/apppasswords
5. Create new app password:
   - App: Mail
   - Device: Other (Custom name) â†’ "Dashboard App"
6. **Copy the 16-character password** (e.g., `abcd efgh ijkl mnop`)

### **Step 2: Set Up OAuth Token (Alternative - More Secure)**

For Gmail API with OAuth (recommended):

1. **Enable Gmail API:**
   - Go to: https://console.cloud.google.com/
   - Create new project or select existing
   - Enable "Gmail API"
   
2. **Create OAuth Credentials:**
   - Go to **Credentials**
   - Create OAuth 2.0 Client ID
   - Application type: Desktop app
   - Download JSON (save as `credentials.json`)

3. **Generate Token:**
   - Place `credentials.json` in `api/` folder
   - Run authentication script (see below)

---

## ğŸ”‘ **Quick Setup Script:**

Create this file: `api/setup_gmail.py`

```python
from google_auth_oauthlib.flow import InstalledAppFlow
from google.auth.transport.requests import Request
from google.oauth2.credentials import Credentials
import os

SCOPES = ['https://www.googleapis.com/auth/gmail.send']

def main():
    creds = None
    if os.path.exists('token.json'):
        creds = Credentials.from_authorized_user_file('token.json', SCOPES)
    
    if not creds or not creds.valid:
        if creds and creds.expired and creds.refresh_token:
            creds.refresh(Request())
        else:
            flow = InstalledAppFlow.from_client_secrets_file(
                'credentials.json', SCOPES)
            creds = flow.run_local_server(port=0)
        
        with open('token.json', 'w') as token:
            token.write(creds.to_json())
    
    print("âœ… Gmail authentication successful!")
    print("token.json file created - copy this to your EC2 server")

if __name__ == '__main__':
    main()
```

Run it:
```bash
cd api
python setup_gmail.py
```

---

## ğŸ“ **File Configuration:**

### **On Your Local Machine:**

Place in `api/` folder:
- `credentials.json` (from Google Cloud Console)
- `token.json` (generated by setup script)

### **On EC2 Server:**

1. Upload `token.json` to EC2:
```bash
scp -i your-key.pem api/token.json ubuntu@13.61.12.168:/var/www/dashboard/api/
```

2. Set environment variable:
```bash
export DISABLE_EMAIL=0
```

3. Restart backend:
```bash
pm2 restart dashboard-api
```

---

## âœ‰ï¸ **Email Recipients Configuration:**

**Current Setup (in main.py):**
```python
PEN_EMAIL = 'office@pen.com'           # Client's email
TEST_EMAIL = 'luqmanmirajdeen@gmail.com'  # Your email for testing
```

**Both emails will receive:**
- Initial requests
- First nominations
- Final nominations
- All generated documents

---

## ğŸ§ª **Test Email Sending:**

### **Option 1: Keep Email Disabled (Current)**

With `DISABLE_EMAIL=1` (default):
- âœ… All forms work
- âœ… PDFs generate
- âŒ No emails sent (just prints to console)

**Good for testing without email setup**

### **Option 2: Enable Email**

With `DISABLE_EMAIL=0` and `token.json`:
- âœ… All forms work
- âœ… PDFs generate
- âœ… Emails sent to BOTH addresses

---

## ğŸš€ **Quick Test (Without Email Setup):**

Currently working:
1. Fill any form
2. Submit
3. PDF generates âœ…
4. Console shows: `[LOCAL TEST] Email disabled or token missing. Skipping send.`

**This is fine for testing!** The PDFs still generate correctly.

---

## ğŸ“Š **Email Flow:**

### **When Form Submitted:**

```
User fills form â†’ Backend processes â†’ Generates PDF
                                    â†“
                    Email sent to: office@pen.com
                                   luqmanmirajdeen@gmail.com
```

**You'll receive copies of all nominations and invoices!**

---

## âœ… **Current Status:**

- âœ… Email recipients configured (both emails)
- âœ… Email sending code ready
- â³ Needs Gmail OAuth token for actual sending
- âœ… PDFs generate regardless of email status

**Commit and push these changes?** This adds your email to all outgoing reports! ğŸ“§

